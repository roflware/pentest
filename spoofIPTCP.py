#!/usr/bin/env python
 
import socket,sys
from impacket import ImpactDecoder, ImpactPacket
 
src = sys.argv[1]
dst = sys.argv[2]
sport = 80
dport = 8000

#Create a new IP packet and set its source and destination addresses
 
ip = ImpactPacket.IP()
ip.set_ip_src(src)
ip.set_ip_dst(dst)
 
#Create a new ICMP packet
 
tcp = ImpactPacket.TCP()

tcp.set_th_sport(sport)
tcp.set_th_dport(dport)

#inlude a small payload inside the ICMP packet
#and have the ip packet contain the ICMP packet

#tcp.contains(ImpactPacket.Data("a"*100))
tcp.contains(ImpactPacket.Data("\x41"*20))
ip.contains(tcp)

s = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_TCP)
s.setsockopt(socket.IPPROTO_IP, socket.IP_HDRINCL, 1)
s.sendto(ip.get_packet(), (dst, 0))
